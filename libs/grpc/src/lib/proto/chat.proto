syntax = "proto3";

package chat;

service ChatService {
  rpc GetChats(GetChatsRequest) returns (GetChatsResponse);
  rpc CreateChat(CreateChatRequest) returns (CreateChatResponse);
  rpc GetManyConversations(GetManyConversationsRequest) returns (GetManyConversationsResponse);

  rpc GetManyComplaints(GetManyComplaintsRequest) returns (GetManyComplaintsResponse);
  rpc CreateComplaint(CreateComplaintRequest) returns (GetComplaintResponse);
  rpc UpdateComplaintStatus(UpdateComplaintStatusRequest) returns (GetComplaintResponse);
  rpc GetManyComplaintMessages(GetManyComplaintMessagesRequest) returns (GetManyComplaintMessagesResponse);
  rpc CreateComplaintMessage(CreateComplaintMessageRequest) returns (ComplaintMessage);
}

// Chat
message Chat {
  string id = 1;
  string fromUserId = 2;
  string toUserId = 3;
  string content = 4;
  string createdAt = 5;
}

// GetChats
message GetChatsRequest {
  string fromUserId = 1;
  string toUserId = 2;
  int32 page = 3;
  int32 limit = 4;
}

message GetChatsResponse {
  repeated Chat chats = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}

// CreateChat
message CreateChatRequest {
  string fromUserId = 1;
  string toUserId = 2;
  string content = 3;
}

message CreateChatResponse {
  string id = 1;
  string fromUserId = 2;
  string toUserId = 3;
  string content = 4;
  string createdAt = 5;
}

// GetManyConversations
message GetManyConversationsRequest {
  string adminId = 1;
  int32 page = 2;
  int32 limit = 3;
}

message ManyConversationsWithUserInformation{
  string userId = 1;
  string fullName = 2;
  string avatarUrl = 3;
  string lastMessage = 4;
  string lastMessageAt = 5;
}

message GetManyConversationsWithUserInformation {
  repeated ManyConversationsWithUserInformation conversations = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}


message ManyConversationsResponse {
  string userId = 1;
  string lastMessage = 2;
  string lastMessageAt = 3;
}

message GetManyConversationsResponse {
  repeated ManyConversationsResponse conversations = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}

// Complaint
message Complaint {
  string complaintId = 1;
  string userId = 2;
  string title = 3;
  string status = 4;
  string lastMessage = 5;
  string lastMessageAt = 6;
  string createdAt = 7;
}

// GetManyComplaints
message GetManyComplaintsRequest {
  optional string status = 1;
  optional string userId = 2;
  int32 page = 3;
  int32 limit = 4;
}

message GetManyComplaintsResponse {
  repeated Complaint complaints = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}

message ManyComplaintsWithUserInformation {
  string complaintId = 1;
  string userId = 2;
  string title = 3;
  string status = 4;
  string avatarUrl = 5;
  string lastMessage = 6;
  string lastMessageAt = 7;
  string createdAt = 8;
}

message GetManyComplaintsWithUserInformation {
  repeated ManyComplaintsWithUserInformation complaints = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}


// CreateComplaint
message CreateComplaintRequest {
  string userId = 1;
  string title = 2;
}

message GetComplaintResponse {
  string id = 1;
  string userId = 2;
  string title = 3;
  string status = 4;
  string createdAt = 5;
  string updatedAt = 6;
}

// UpdateComplaintStatus
message UpdateComplaintStatusRequest {
  string id = 1;
  string status = 2;
}

// ComplaintMessage
message ComplaintMessage {
  string id = 1;
  string complaintId = 2;
  string senderId = 3;
  string messageType = 4;
  string content = 5;
  string createdAt = 6;
}

// GetManyComplaintMessages
message GetManyComplaintMessagesRequest {
  string complaintId = 1;
  int32 page = 2;
  int32 limit = 3;
}

message GetManyComplaintMessagesResponse {
  repeated ComplaintMessage complaintMessages = 1;
  int32 page = 2;
  int32 limit = 3;
  int32 totalItems = 4;
  int32 totalPages = 5;
}

// CreateComplaintMessage
message CreateComplaintMessageRequest {
  string complaintId = 1;
  string senderId = 2;
  string messageType = 3;
  string content = 4;
}